id: uipath_log_data
learningObjectives:
  - Log data in test flow
startFlow:
  do:
    - actionId: bot_message
      params:
        person: lucca
        messages:
          - text: We want to see some feedback from our flow, we'll use a new action called `Log Message`
          - text: We'll :instruction[Click on the [+] Plus sign] and search for `Log Message`
          - text: In the message input field choose your new variable `theincrediblevar` and log level as `Info`
    - actionId: bot_message
      params:
        person: lucca
        messages: 
          - text: Now its time to test your work :instruction[Click `Test on cloud` from top left corner] and see it in action.
          - text: I'm going to check how you did, once I validate it you'll be able to continue.
    - actionId: ready_message
      params:
        person: lucca
trigger:
  type: user_event
  params:
    event: uipath
  flowNode:
    do:
     - actionId: network_http_request
        name: robot_logs
        params:
          url: "https://cloud.uipath.com/${user.properties.uipath_orgName}/${user.properties.uipath_tenantName}/orchestrator_/odata/RobotLogs"
          method: GET
          data: 
            X-UIPATH-OrganizationUnitId: ${user.properties.uipath_orgnId}
            Authorization: 'Bearer ${user.properties.uipath_accessToken}'
    if:
      conditions:
        - conditionId: text_contains_strings
          params:
            text: ${outputs.robot_logs.value.find(item => item.Message === "Lets do this Wilco!");}
            strings:
            - "Lets do this Wilco!"
      then:
        do:
        - actionId: bot_message
          params:
            person: lucca
            messages:
            - text: "Lets do this! You managed to set everything up, print to console. Time to move to some advance things now."
        - actionId: finish_step
      else:
        do:
        - actionId: bot_message
          params:
            person: lucca
            messages:
            - text: "Seems we're not quite there yet. Please recheck that you set the variable to `Lets do this Wilco!`"